2026-01-23 21:10:11,039 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:11,039 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'mistralai/Mistral-7B-Instruct-v0.2', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'hotpotqa', 'test_dataset': 'hotpotqa_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:11,041 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'mistralai/Mistral-7B-Instruct-v0.2'
2026-01-23 21:10:11,042 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'mistralai/Mistral-7B-Instruct-v0.2' using training dataset 'hotpotqa'.
2026-01-23 21:10:11,055 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:11,120 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:11,122 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:11,123 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   1%|          | 6/1000 [00:00<00:16, 59.18it/s]Extracting labels:   2%|▏         | 19/1000 [00:00<00:10, 97.36it/s]Extracting labels:   3%|▎         | 31/1000 [00:00<00:09, 107.08it/s]Extracting labels:   4%|▍         | 45/1000 [00:00<00:08, 116.13it/s]Extracting labels:   6%|▌         | 61/1000 [00:00<00:07, 130.22it/s]Extracting labels:   8%|▊         | 76/1000 [00:00<00:06, 136.73it/s]Extracting labels:   9%|▉         | 92/1000 [00:00<00:06, 135.93it/s]Extracting labels:  11%|█         | 106/1000 [00:00<00:06, 132.82it/s]Extracting labels:  12%|█▏        | 121/1000 [00:00<00:06, 137.72it/s]Extracting labels:  14%|█▎        | 135/1000 [00:01<00:06, 137.85it/s]Extracting labels:  15%|█▌        | 151/1000 [00:01<00:06, 136.85it/s]Extracting labels:  16%|█▋        | 165/1000 [00:01<00:06, 136.33it/s]Extracting labels:  18%|█▊        | 179/1000 [00:01<00:06, 127.94it/s]Extracting labels:  20%|█▉        | 196/1000 [00:01<00:05, 137.79it/s]Extracting labels:  21%|██        | 212/1000 [00:01<00:05, 143.22it/s]Extracting labels:  23%|██▎       | 228/1000 [00:01<00:05, 146.33it/s]Extracting labels:  24%|██▍       | 243/1000 [00:01<00:05, 136.14it/s]Extracting labels:  26%|██▌       | 257/1000 [00:01<00:05, 127.93it/s]Extracting labels:  27%|██▋       | 273/1000 [00:02<00:05, 136.38it/s]Extracting labels:  29%|██▊       | 287/1000 [00:02<00:05, 136.31it/s]Extracting labels:  30%|███       | 301/1000 [00:02<00:05, 135.32it/s]Extracting labels:  32%|███▏      | 315/1000 [00:02<00:05, 125.86it/s]Extracting labels:  33%|███▎      | 328/1000 [00:02<00:05, 126.63it/s]Extracting labels:  34%|███▍      | 341/1000 [00:02<00:05, 114.51it/s]Extracting labels:  36%|███▌      | 355/1000 [00:02<00:05, 119.48it/s]Extracting labels:  37%|███▋      | 369/1000 [00:02<00:05, 123.36it/s]Extracting labels:  38%|███▊      | 383/1000 [00:02<00:04, 126.85it/s]Extracting labels:  40%|███▉      | 397/1000 [00:03<00:04, 128.88it/s]Extracting labels:  41%|████      | 411/1000 [00:03<00:05, 114.76it/s]Extracting labels:  42%|████▏     | 423/1000 [00:03<00:05, 114.79it/s]Extracting labels:  44%|████▎     | 437/1000 [00:03<00:04, 116.22it/s]Extracting labels:  45%|████▍     | 449/1000 [00:03<00:04, 117.14it/s]Extracting labels:  46%|████▋     | 465/1000 [00:03<00:04, 126.43it/s]Extracting labels:  48%|████▊     | 478/1000 [00:03<00:04, 126.35it/s]Extracting labels:  49%|████▉     | 492/1000 [00:03<00:03, 129.56it/s]Extracting labels:  51%|█████     | 506/1000 [00:03<00:04, 119.09it/s]Extracting labels:  52%|█████▏    | 519/1000 [00:04<00:04, 117.18it/s]Extracting labels:  53%|█████▎    | 534/1000 [00:04<00:03, 125.48it/s]Extracting labels:  55%|█████▌    | 550/1000 [00:04<00:03, 134.36it/s]Extracting labels:  56%|█████▋    | 564/1000 [00:04<00:03, 123.00it/s]Extracting labels:  58%|█████▊    | 577/1000 [00:04<00:03, 111.23it/s]Extracting labels:  59%|█████▉    | 590/1000 [00:04<00:03, 114.93it/s]Extracting labels:  61%|██████    | 606/1000 [00:04<00:03, 126.63it/s]Extracting labels:  62%|██████▏   | 620/1000 [00:04<00:03, 108.43it/s]Extracting labels:  64%|██████▎   | 635/1000 [00:05<00:03, 118.28it/s]Extracting labels:  65%|██████▍   | 649/1000 [00:05<00:02, 122.28it/s]Extracting labels:  66%|██████▌   | 662/1000 [00:05<00:02, 122.31it/s]Extracting labels:  68%|██████▊   | 678/1000 [00:05<00:02, 120.41it/s]Extracting labels:  69%|██████▉   | 694/1000 [00:05<00:02, 129.56it/s]Extracting labels:  71%|███████   | 708/1000 [00:05<00:02, 129.55it/s]Extracting labels:  72%|███████▏  | 722/1000 [00:05<00:02, 130.51it/s]Extracting labels:  74%|███████▍  | 738/1000 [00:05<00:01, 137.93it/s]Extracting labels:  75%|███████▌  | 752/1000 [00:05<00:01, 136.61it/s]Extracting labels:  77%|███████▋  | 766/1000 [00:06<00:01, 124.96it/s]Extracting labels:  78%|███████▊  | 779/1000 [00:06<00:01, 121.59it/s]Extracting labels:  79%|███████▉  | 792/1000 [00:06<00:01, 120.04it/s]Extracting labels:  81%|████████  | 806/1000 [00:06<00:01, 123.63it/s]Extracting labels:  82%|████████▏ | 819/1000 [00:06<00:01, 119.97it/s]Extracting labels:  83%|████████▎ | 832/1000 [00:06<00:01, 118.58it/s]Extracting labels:  84%|████████▍ | 845/1000 [00:06<00:01, 119.92it/s]Extracting labels:  86%|████████▌ | 861/1000 [00:06<00:01, 130.00it/s]Extracting labels:  88%|████████▊ | 875/1000 [00:06<00:00, 131.53it/s]Extracting labels:  89%|████████▉ | 889/1000 [00:07<00:00, 125.13it/s]Extracting labels:  90%|█████████ | 905/1000 [00:07<00:00, 133.41it/s]Extracting labels:  92%|█████████▏| 922/1000 [00:07<00:00, 142.55it/s]Extracting labels:  94%|█████████▎| 937/1000 [00:07<00:00, 143.60it/s]Extracting labels:  95%|█████████▌| 954/1000 [00:07<00:00, 150.11it/s]Extracting labels:  97%|█████████▋| 970/1000 [00:07<00:00, 134.47it/s]Extracting labels:  98%|█████████▊| 984/1000 [00:07<00:00, 127.82it/s]Extracting labels: 100%|█████████▉| 999/1000 [00:07<00:00, 130.11it/s]Extracting labels: 100%|██████████| 1000/1000 [00:07<00:00, 126.96it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 36599.51it/s]
2026-01-23 21:10:19,007 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:10:19,077 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:10:19,080 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:10:19,089 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:10:19,393 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:10:19,394 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:10:19,396 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:10:19,397 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/mistralai/Mistral-7B-Instruct-v0.2/hotpotqa with this file name: 5419397709.
2026-01-23 21:10:19,398 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:10:19,400 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
