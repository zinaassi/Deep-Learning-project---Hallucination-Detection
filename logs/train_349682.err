2026-01-23 21:15:12,967 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:15:12,967 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'Qwen/Qwen2.5-7B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'movies', 'test_dataset': 'movies_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:15:12,968 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'Qwen/Qwen2.5-7B-Instruct'
2026-01-23 21:15:12,970 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'Qwen/Qwen2.5-7B-Instruct' using training dataset 'movies'.
2026-01-23 21:15:12,980 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:15:13,031 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:15:13,032 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:15:13,033 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   1%|▏         | 14/1000 [00:00<00:07, 139.84it/s]Extracting labels:   3%|▎         | 30/1000 [00:00<00:06, 140.16it/s]Extracting labels:   4%|▍         | 45/1000 [00:00<00:06, 139.90it/s]Extracting labels:   6%|▌         | 59/1000 [00:00<00:06, 135.46it/s]Extracting labels:   7%|▋         | 74/1000 [00:00<00:06, 140.18it/s]Extracting labels:   9%|▉         | 89/1000 [00:00<00:06, 137.33it/s]Extracting labels:  10%|█         | 104/1000 [00:00<00:06, 139.93it/s]Extracting labels:  12%|█▏        | 119/1000 [00:00<00:06, 142.33it/s]Extracting labels:  13%|█▎        | 134/1000 [00:00<00:06, 135.60it/s]Extracting labels:  15%|█▍        | 149/1000 [00:01<00:06, 134.17it/s]Extracting labels:  16%|█▋        | 163/1000 [00:01<00:06, 131.59it/s]Extracting labels:  18%|█▊        | 179/1000 [00:01<00:05, 137.16it/s]Extracting labels:  19%|█▉        | 194/1000 [00:01<00:05, 137.65it/s]Extracting labels:  21%|██        | 209/1000 [00:01<00:05, 138.74it/s]Extracting labels:  22%|██▏       | 223/1000 [00:01<00:05, 133.67it/s]Extracting labels:  24%|██▎       | 237/1000 [00:01<00:05, 127.32it/s]Extracting labels:  25%|██▌       | 250/1000 [00:01<00:05, 125.38it/s]Extracting labels:  26%|██▋       | 263/1000 [00:01<00:06, 119.95it/s]Extracting labels:  28%|██▊       | 276/1000 [00:02<00:06, 120.06it/s]Extracting labels:  29%|██▉       | 292/1000 [00:02<00:05, 128.65it/s]Extracting labels:  31%|███       | 307/1000 [00:02<00:05, 131.67it/s]Extracting labels:  32%|███▏      | 321/1000 [00:02<00:05, 130.60it/s]Extracting labels:  34%|███▎      | 335/1000 [00:02<00:05, 132.42it/s]Extracting labels:  35%|███▍      | 349/1000 [00:02<00:05, 125.47it/s]Extracting labels:  36%|███▌      | 362/1000 [00:02<00:05, 124.77it/s]Extracting labels:  38%|███▊      | 375/1000 [00:02<00:05, 120.57it/s]Extracting labels:  39%|███▉      | 390/1000 [00:02<00:04, 126.76it/s]Extracting labels:  40%|████      | 404/1000 [00:03<00:04, 129.05it/s]Extracting labels:  42%|████▏     | 417/1000 [00:03<00:04, 124.54it/s]Extracting labels:  43%|████▎     | 430/1000 [00:03<00:04, 123.25it/s]Extracting labels:  44%|████▍     | 443/1000 [00:03<00:04, 119.43it/s]Extracting labels:  46%|████▌     | 456/1000 [00:03<00:04, 121.24it/s]Extracting labels:  47%|████▋     | 469/1000 [00:03<00:04, 115.15it/s]Extracting labels:  48%|████▊     | 481/1000 [00:03<00:04, 110.74it/s]Extracting labels:  49%|████▉     | 494/1000 [00:03<00:04, 111.44it/s]Extracting labels:  51%|█████     | 508/1000 [00:03<00:04, 117.66it/s]Extracting labels:  52%|█████▏    | 523/1000 [00:04<00:03, 124.86it/s]Extracting labels:  54%|█████▎    | 537/1000 [00:04<00:03, 125.01it/s]Extracting labels:  55%|█████▌    | 551/1000 [00:04<00:03, 126.40it/s]Extracting labels:  56%|█████▋    | 564/1000 [00:04<00:03, 121.81it/s]Extracting labels:  58%|█████▊    | 580/1000 [00:04<00:03, 131.46it/s]Extracting labels:  59%|█████▉    | 594/1000 [00:04<00:03, 130.03it/s]Extracting labels:  61%|██████    | 610/1000 [00:04<00:02, 137.29it/s]Extracting labels:  63%|██████▎   | 626/1000 [00:04<00:02, 143.60it/s]Extracting labels:  64%|██████▍   | 642/1000 [00:04<00:02, 147.89it/s]Extracting labels:  66%|██████▌   | 657/1000 [00:05<00:02, 144.57it/s]Extracting labels:  67%|██████▋   | 672/1000 [00:05<00:02, 138.42it/s]Extracting labels:  69%|██████▉   | 688/1000 [00:05<00:02, 142.05it/s]Extracting labels:  70%|███████   | 703/1000 [00:05<00:02, 144.00it/s]Extracting labels:  72%|███████▏  | 718/1000 [00:05<00:01, 142.41it/s]Extracting labels:  73%|███████▎  | 733/1000 [00:05<00:01, 134.52it/s]Extracting labels:  75%|███████▍  | 748/1000 [00:05<00:01, 136.30it/s]Extracting labels:  76%|███████▋  | 763/1000 [00:05<00:01, 138.58it/s]Extracting labels:  78%|███████▊  | 777/1000 [00:05<00:01, 126.49it/s]Extracting labels:  79%|███████▉  | 790/1000 [00:06<00:01, 124.59it/s]Extracting labels:  80%|████████  | 805/1000 [00:06<00:01, 131.49it/s]Extracting labels:  82%|████████▏ | 822/1000 [00:06<00:01, 140.76it/s]Extracting labels:  84%|████████▍ | 838/1000 [00:06<00:01, 143.78it/s]Extracting labels:  85%|████████▌ | 853/1000 [00:06<00:01, 132.89it/s]Extracting labels:  87%|████████▋ | 869/1000 [00:06<00:00, 137.34it/s]Extracting labels:  88%|████████▊ | 883/1000 [00:06<00:00, 128.01it/s]Extracting labels:  90%|████████▉ | 897/1000 [00:06<00:00, 122.34it/s]Extracting labels:  91%|█████████ | 910/1000 [00:06<00:00, 115.83it/s]Extracting labels:  92%|█████████▏| 924/1000 [00:07<00:00, 120.88it/s]Extracting labels:  94%|█████████▎| 937/1000 [00:07<00:00, 113.91it/s]Extracting labels:  95%|█████████▌| 950/1000 [00:07<00:00, 113.63it/s]Extracting labels:  96%|█████████▌| 962/1000 [00:07<00:00, 108.31it/s]Extracting labels:  98%|█████████▊| 976/1000 [00:07<00:00, 115.05it/s]Extracting labels:  99%|█████████▉| 990/1000 [00:07<00:00, 120.41it/s]Extracting labels: 100%|██████████| 1000/1000 [00:07<00:00, 128.73it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 44150.57it/s]
2026-01-23 21:15:20,809 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:15:20,884 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:15:20,886 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:15:20,894 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:15:21,250 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:15:21,252 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:15:21,255 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:15:21,257 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/Qwen/Qwen2.5-7B-Instruct/movies with this file name: 5721257638.
2026-01-23 21:15:21,259 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:15:21,260 - AppLogger - [INFO] - main.py:352 - Starting training loop.
2026-01-23 21:15:22,765 - AppLogger - [INFO] - main.py:190 - Epoch 1/100
Training Progress:   0%|          | 0/13 [00:00<?, ?it/s]../aten/src/ATen/native/cuda/Loss.cu:94: operator(): block: [0,0,0], thread: [46,0,0] Assertion `input_val >= zero && input_val <= one` failed.
../aten/src/ATen/native/cuda/Loss.cu:94: operator(): block: [0,0,0], thread: [25,0,0] Assertion `input_val >= zero && input_val <= one` failed.
Training Progress:   0%|          | 0/13 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 356, in main
    train_model(logger=logger, model=model, dataloader_train=dataloader_train, dataloader_val=dataloader_val, dataloader_test=dataloader_test, criterion=criterion, optimizer=optimizer, scheduler=scheduler, args=args, device=device)
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 193, in train_model
    train_loss, auc_train = train_one_epoch(model, dataloader_train, criterion, optimizer, scheduler, device, input_type=args.input_type)
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 132, in train_one_epoch
    loss.backward()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/torch/autograd/__init__.py", line 259, in backward
    grad_tensors_ = _make_grads(tensors, grad_tensors_, is_grads_batched=False)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/torch/autograd/__init__.py", line 142, in _make_grads
    torch.ones_like(out, memory_format=torch.preserve_format)
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

