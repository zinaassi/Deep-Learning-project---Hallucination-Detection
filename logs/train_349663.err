2026-01-23 21:10:32,416 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:32,416 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'mistralai/Mistral-7B-Instruct-v0.2', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'imdb', 'test_dataset': 'imdb_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:32,418 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'mistralai/Mistral-7B-Instruct-v0.2'
2026-01-23 21:10:32,419 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'mistralai/Mistral-7B-Instruct-v0.2' using training dataset 'imdb'.
2026-01-23 21:10:32,429 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:32,489 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:32,490 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:32,492 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   1%|          | 8/1000 [00:00<00:12, 78.68it/s]Extracting labels:   2%|▏         | 21/1000 [00:00<00:09, 107.59it/s]Extracting labels:   3%|▎         | 32/1000 [00:00<00:09, 103.58it/s]Extracting labels:   5%|▍         | 46/1000 [00:00<00:08, 115.69it/s]Extracting labels:   6%|▌         | 58/1000 [00:00<00:08, 111.87it/s]Extracting labels:   7%|▋         | 70/1000 [00:00<00:08, 107.59it/s]Extracting labels:   8%|▊         | 84/1000 [00:00<00:07, 116.63it/s]Extracting labels:  10%|▉         | 97/1000 [00:00<00:07, 120.46it/s]Extracting labels:  11%|█         | 111/1000 [00:00<00:07, 123.22it/s]Extracting labels:  12%|█▎        | 125/1000 [00:01<00:06, 126.67it/s]Extracting labels:  14%|█▍        | 138/1000 [00:01<00:06, 124.83it/s]Extracting labels:  15%|█▌        | 151/1000 [00:01<00:07, 119.66it/s]Extracting labels:  17%|█▋        | 166/1000 [00:01<00:06, 126.57it/s]Extracting labels:  18%|█▊        | 181/1000 [00:01<00:06, 132.03it/s]Extracting labels:  20%|█▉        | 195/1000 [00:01<00:06, 132.14it/s]Extracting labels:  21%|██        | 209/1000 [00:01<00:06, 114.06it/s]Extracting labels:  22%|██▏       | 221/1000 [00:01<00:07, 105.45it/s]Extracting labels:  23%|██▎       | 234/1000 [00:02<00:06, 109.87it/s]Extracting labels:  25%|██▍       | 246/1000 [00:02<00:07, 100.85it/s]Extracting labels:  26%|██▌       | 258/1000 [00:02<00:07, 104.80it/s]Extracting labels:  27%|██▋       | 269/1000 [00:02<00:07, 102.26it/s]Extracting labels:  28%|██▊       | 285/1000 [00:02<00:06, 117.12it/s]Extracting labels:  30%|██▉       | 299/1000 [00:02<00:05, 121.00it/s]Extracting labels:  31%|███       | 312/1000 [00:02<00:05, 118.34it/s]Extracting labels:  32%|███▎      | 325/1000 [00:02<00:06, 105.12it/s]Extracting labels:  34%|███▎      | 337/1000 [00:02<00:06, 104.82it/s]Extracting labels:  35%|███▌      | 351/1000 [00:03<00:05, 111.71it/s]Extracting labels:  36%|███▋      | 363/1000 [00:03<00:05, 113.83it/s]Extracting labels:  38%|███▊      | 377/1000 [00:03<00:05, 117.32it/s]Extracting labels:  39%|███▉      | 389/1000 [00:03<00:05, 117.92it/s]Extracting labels:  40%|████      | 401/1000 [00:03<00:05, 116.06it/s]Extracting labels:  42%|████▏     | 417/1000 [00:03<00:04, 128.10it/s]Extracting labels:  43%|████▎     | 430/1000 [00:03<00:04, 123.89it/s]Extracting labels:  44%|████▍     | 443/1000 [00:03<00:04, 119.37it/s]Extracting labels:  46%|████▌     | 457/1000 [00:03<00:04, 123.40it/s]Extracting labels:  47%|████▋     | 470/1000 [00:04<00:04, 118.80it/s]Extracting labels:  48%|████▊     | 484/1000 [00:04<00:04, 123.86it/s]Extracting labels:  50%|████▉     | 498/1000 [00:04<00:03, 127.02it/s]Extracting labels:  51%|█████     | 511/1000 [00:04<00:04, 119.28it/s]Extracting labels:  52%|█████▏    | 524/1000 [00:04<00:04, 115.79it/s]Extracting labels:  54%|█████▍    | 540/1000 [00:04<00:03, 124.79it/s]Extracting labels:  55%|█████▌    | 554/1000 [00:04<00:03, 125.30it/s]Extracting labels:  57%|█████▋    | 567/1000 [00:04<00:03, 110.25it/s]Extracting labels:  58%|█████▊    | 582/1000 [00:04<00:03, 119.52it/s]Extracting labels:  60%|█████▉    | 595/1000 [00:05<00:03, 109.08it/s]Extracting labels:  61%|██████    | 610/1000 [00:05<00:03, 117.62it/s]Extracting labels:  62%|██████▎   | 625/1000 [00:05<00:02, 126.04it/s]Extracting labels:  64%|██████▍   | 640/1000 [00:05<00:02, 131.47it/s]Extracting labels:  66%|██████▌   | 655/1000 [00:05<00:02, 135.12it/s]Extracting labels:  67%|██████▋   | 669/1000 [00:05<00:02, 134.58it/s]Extracting labels:  68%|██████▊   | 683/1000 [00:05<00:02, 130.32it/s]Extracting labels:  70%|██████▉   | 697/1000 [00:05<00:02, 131.21it/s]Extracting labels:  71%|███████   | 711/1000 [00:05<00:02, 126.80it/s]Extracting labels:  72%|███████▏  | 724/1000 [00:06<00:02, 127.57it/s]Extracting labels:  74%|███████▎  | 737/1000 [00:06<00:02, 127.48it/s]Extracting labels:  75%|███████▌  | 753/1000 [00:06<00:01, 136.13it/s]Extracting labels:  77%|███████▋  | 767/1000 [00:06<00:01, 128.51it/s]Extracting labels:  78%|███████▊  | 780/1000 [00:06<00:01, 116.92it/s]Extracting labels:  79%|███████▉  | 794/1000 [00:06<00:01, 118.04it/s]Extracting labels:  81%|████████  | 806/1000 [00:06<00:01, 116.61it/s]Extracting labels:  82%|████████▏ | 819/1000 [00:06<00:01, 118.61it/s]Extracting labels:  83%|████████▎ | 831/1000 [00:07<00:01, 111.48it/s]Extracting labels:  84%|████████▍ | 844/1000 [00:07<00:01, 115.53it/s]Extracting labels:  86%|████████▌ | 856/1000 [00:07<00:01, 114.21it/s]Extracting labels:  87%|████████▋ | 869/1000 [00:07<00:01, 116.18it/s]Extracting labels:  88%|████████▊ | 883/1000 [00:07<00:00, 121.27it/s]Extracting labels:  90%|████████▉ | 897/1000 [00:07<00:00, 126.07it/s]Extracting labels:  91%|█████████ | 911/1000 [00:07<00:00, 129.38it/s]Extracting labels:  92%|█████████▎| 925/1000 [00:07<00:00, 129.94it/s]Extracting labels:  94%|█████████▍| 939/1000 [00:07<00:00, 127.85it/s]Extracting labels:  95%|█████████▌| 952/1000 [00:07<00:00, 122.50it/s]Extracting labels:  96%|█████████▋| 965/1000 [00:08<00:00, 109.02it/s]Extracting labels:  98%|█████████▊| 979/1000 [00:08<00:00, 116.56it/s]Extracting labels:  99%|█████████▉| 991/1000 [00:08<00:00, 111.74it/s]Extracting labels: 100%|██████████| 1000/1000 [00:08<00:00, 116.93it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 43509.38it/s]
2026-01-23 21:10:41,051 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:10:41,115 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:10:41,117 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:10:41,126 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:10:41,458 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:10:41,459 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:10:41,461 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:10:41,463 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/mistralai/Mistral-7B-Instruct-v0.2/imdb with this file name: 5441463204.
2026-01-23 21:10:41,464 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:10:41,465 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
