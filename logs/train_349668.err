2026-01-23 21:10:56,402 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:56,404 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'Qwen/Qwen2.5-7B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'movies', 'test_dataset': 'movies_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:56,405 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'Qwen/Qwen2.5-7B-Instruct'
2026-01-23 21:10:56,406 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'Qwen/Qwen2.5-7B-Instruct' using training dataset 'movies'.
2026-01-23 21:10:56,417 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:56,462 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:56,463 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:56,464 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   2%|▏         | 20/1000 [00:00<00:05, 190.87it/s]Extracting labels:   4%|▍         | 40/1000 [00:00<00:05, 191.61it/s]Extracting labels:   6%|▌         | 60/1000 [00:00<00:05, 185.27it/s]Extracting labels:   8%|▊         | 79/1000 [00:00<00:05, 180.07it/s]Extracting labels:  10%|▉         | 98/1000 [00:00<00:04, 181.93it/s]Extracting labels:  12%|█▏        | 117/1000 [00:00<00:04, 181.76it/s]Extracting labels:  14%|█▎        | 136/1000 [00:00<00:04, 183.13it/s]Extracting labels:  16%|█▌        | 155/1000 [00:00<00:04, 179.59it/s]Extracting labels:  17%|█▋        | 174/1000 [00:00<00:04, 180.75it/s]Extracting labels:  19%|█▉        | 193/1000 [00:01<00:04, 178.93it/s]Extracting labels:  21%|██        | 212/1000 [00:01<00:04, 179.69it/s]Extracting labels:  23%|██▎       | 230/1000 [00:01<00:04, 179.38it/s]Extracting labels:  25%|██▍       | 249/1000 [00:01<00:04, 179.81it/s]Extracting labels:  27%|██▋       | 268/1000 [00:01<00:04, 180.60it/s]Extracting labels:  29%|██▊       | 287/1000 [00:01<00:03, 178.68it/s]Extracting labels:  30%|███       | 305/1000 [00:01<00:04, 169.45it/s]Extracting labels:  32%|███▏      | 323/1000 [00:01<00:03, 171.30it/s]Extracting labels:  34%|███▍      | 341/1000 [00:01<00:03, 173.27it/s]Extracting labels:  36%|███▌      | 360/1000 [00:02<00:03, 176.66it/s]Extracting labels:  38%|███▊      | 379/1000 [00:02<00:03, 178.86it/s]Extracting labels:  40%|███▉      | 398/1000 [00:02<00:03, 178.49it/s]Extracting labels:  42%|████▏     | 416/1000 [00:02<00:03, 176.18it/s]Extracting labels:  43%|████▎     | 434/1000 [00:02<00:03, 172.73it/s]Extracting labels:  45%|████▌     | 452/1000 [00:02<00:03, 174.20it/s]Extracting labels:  47%|████▋     | 470/1000 [00:02<00:03, 175.47it/s]Extracting labels:  49%|████▉     | 489/1000 [00:02<00:02, 178.08it/s]Extracting labels:  51%|█████     | 508/1000 [00:02<00:02, 180.87it/s]Extracting labels:  53%|█████▎    | 527/1000 [00:02<00:02, 182.00it/s]Extracting labels:  55%|█████▍    | 546/1000 [00:03<00:02, 181.58it/s]Extracting labels:  56%|█████▋    | 565/1000 [00:03<00:02, 179.79it/s]Extracting labels:  58%|█████▊    | 583/1000 [00:03<00:02, 179.35it/s]Extracting labels:  60%|██████    | 602/1000 [00:03<00:02, 180.05it/s]Extracting labels:  62%|██████▏   | 621/1000 [00:03<00:02, 180.31it/s]Extracting labels:  64%|██████▍   | 640/1000 [00:03<00:01, 181.14it/s]Extracting labels:  66%|██████▌   | 659/1000 [00:03<00:01, 179.36it/s]Extracting labels:  68%|██████▊   | 678/1000 [00:03<00:01, 180.44it/s]Extracting labels:  70%|██████▉   | 697/1000 [00:03<00:01, 178.72it/s]Extracting labels:  72%|███████▏  | 715/1000 [00:03<00:01, 178.48it/s]Extracting labels:  73%|███████▎  | 733/1000 [00:04<00:01, 176.28it/s]Extracting labels:  75%|███████▌  | 751/1000 [00:04<00:01, 176.92it/s]Extracting labels:  77%|███████▋  | 769/1000 [00:04<00:01, 177.22it/s]Extracting labels:  79%|███████▊  | 787/1000 [00:04<00:01, 170.32it/s]Extracting labels:  80%|████████  | 805/1000 [00:04<00:01, 172.93it/s]Extracting labels:  82%|████████▏ | 823/1000 [00:04<00:01, 174.90it/s]Extracting labels:  84%|████████▍ | 841/1000 [00:04<00:00, 176.29it/s]Extracting labels:  86%|████████▌ | 859/1000 [00:04<00:00, 177.19it/s]Extracting labels:  88%|████████▊ | 877/1000 [00:04<00:00, 157.96it/s]Extracting labels:  90%|████████▉ | 895/1000 [00:05<00:00, 162.47it/s]Extracting labels:  91%|█████████▏| 913/1000 [00:05<00:00, 165.99it/s]Extracting labels:  93%|█████████▎| 930/1000 [00:05<00:00, 166.36it/s]Extracting labels:  95%|█████████▍| 948/1000 [00:05<00:00, 168.65it/s]Extracting labels:  96%|█████████▋| 965/1000 [00:05<00:00, 166.56it/s]Extracting labels:  98%|█████████▊| 982/1000 [00:05<00:00, 150.89it/s]Extracting labels: 100%|█████████▉| 998/1000 [00:05<00:00, 152.88it/s]Extracting labels: 100%|██████████| 1000/1000 [00:05<00:00, 174.15it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 60787.01it/s]
2026-01-23 21:11:02,213 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:11:02,284 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:11:02,288 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:11:02,297 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:11:02,959 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:11:02,960 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:11:02,962 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:11:02,964 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/Qwen/Qwen2.5-7B-Instruct/movies with this file name: 5462963903.
2026-01-23 21:11:02,965 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:11:02,966 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
