2026-01-23 21:10:11,039 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:11,039 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'meta-llama/Meta-Llama-3-8B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'hotpotqa', 'test_dataset': 'hotpotqa_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:11,041 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'meta-llama/Meta-Llama-3-8B-Instruct'
2026-01-23 21:10:11,042 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'meta-llama/Meta-Llama-3-8B-Instruct' using training dataset 'hotpotqa'.
2026-01-23 21:10:11,055 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:11,128 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:11,129 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:11,130 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   0%|          | 5/1000 [00:00<00:19, 49.78it/s]Extracting labels:   1%|          | 12/1000 [00:00<00:16, 60.29it/s]Extracting labels:   2%|▏         | 23/1000 [00:00<00:12, 77.35it/s]Extracting labels:   3%|▎         | 31/1000 [00:00<00:13, 73.65it/s]Extracting labels:   4%|▍         | 39/1000 [00:00<00:12, 73.99it/s]Extracting labels:   5%|▍         | 47/1000 [00:00<00:13, 68.75it/s]Extracting labels:   5%|▌         | 54/1000 [00:00<00:13, 68.18it/s]Extracting labels:   6%|▋         | 63/1000 [00:00<00:12, 73.76it/s]Extracting labels:   7%|▋         | 71/1000 [00:00<00:12, 74.09it/s]Extracting labels:   8%|▊         | 83/1000 [00:01<00:10, 86.60it/s]Extracting labels:   9%|▉         | 92/1000 [00:01<00:10, 85.55it/s]Extracting labels:  10%|█         | 103/1000 [00:01<00:10, 88.78it/s]Extracting labels:  11%|█▏        | 113/1000 [00:01<00:09, 89.16it/s]Extracting labels:  12%|█▏        | 122/1000 [00:01<00:10, 87.13it/s]Extracting labels:  13%|█▎        | 131/1000 [00:01<00:12, 69.41it/s]Extracting labels:  14%|█▍        | 139/1000 [00:01<00:12, 71.58it/s]Extracting labels:  15%|█▌        | 150/1000 [00:01<00:10, 78.47it/s]Extracting labels:  16%|█▌        | 159/1000 [00:02<00:10, 81.23it/s]Extracting labels:  17%|█▋        | 168/1000 [00:02<00:10, 76.62it/s]Extracting labels:  18%|█▊        | 180/1000 [00:02<00:09, 87.45it/s]Extracting labels:  19%|█▉        | 190/1000 [00:02<00:10, 79.06it/s]Extracting labels:  20%|██        | 200/1000 [00:02<00:09, 80.17it/s]Extracting labels:  21%|██        | 209/1000 [00:02<00:10, 75.13it/s]Extracting labels:  22%|██▏       | 217/1000 [00:02<00:10, 75.57it/s]Extracting labels:  23%|██▎       | 226/1000 [00:02<00:09, 78.27it/s]Extracting labels:  23%|██▎       | 234/1000 [00:03<00:10, 76.07it/s]Extracting labels:  24%|██▍       | 245/1000 [00:03<00:09, 81.05it/s]Extracting labels:  25%|██▌       | 254/1000 [00:03<00:09, 79.19it/s]Extracting labels:  27%|██▋       | 266/1000 [00:03<00:08, 86.61it/s]Extracting labels:  28%|██▊       | 277/1000 [00:03<00:07, 92.31it/s]Extracting labels:  29%|██▊       | 287/1000 [00:03<00:08, 85.29it/s]Extracting labels:  30%|██▉       | 298/1000 [00:03<00:07, 90.82it/s]Extracting labels:  31%|███       | 308/1000 [00:03<00:08, 78.22it/s]Extracting labels:  32%|███▏      | 321/1000 [00:03<00:07, 89.92it/s]Extracting labels:  34%|███▎      | 335/1000 [00:04<00:06, 101.62it/s]Extracting labels:  35%|███▍      | 347/1000 [00:04<00:06, 104.48it/s]Extracting labels:  36%|███▌      | 358/1000 [00:04<00:06, 103.69it/s]Extracting labels:  37%|███▋      | 370/1000 [00:04<00:05, 105.05it/s]Extracting labels:  38%|███▊      | 383/1000 [00:04<00:05, 111.75it/s]Extracting labels:  40%|███▉      | 395/1000 [00:04<00:05, 111.61it/s]Extracting labels:  41%|████      | 408/1000 [00:04<00:05, 116.64it/s]Extracting labels:  42%|████▏     | 420/1000 [00:04<00:04, 117.11it/s]Extracting labels:  44%|████▎     | 435/1000 [00:04<00:04, 125.80it/s]Extracting labels:  45%|████▌     | 451/1000 [00:05<00:04, 134.19it/s]Extracting labels:  46%|████▋     | 465/1000 [00:05<00:04, 120.60it/s]Extracting labels:  48%|████▊     | 478/1000 [00:05<00:04, 121.04it/s]Extracting labels:  49%|████▉     | 491/1000 [00:05<00:04, 116.19it/s]Extracting labels:  50%|█████     | 503/1000 [00:05<00:04, 111.19it/s]Extracting labels:  52%|█████▏    | 517/1000 [00:05<00:04, 117.68it/s]Extracting labels:  53%|█████▎    | 531/1000 [00:05<00:03, 123.32it/s]Extracting labels:  54%|█████▍    | 544/1000 [00:05<00:03, 124.37it/s]Extracting labels:  56%|█████▌    | 558/1000 [00:05<00:03, 127.99it/s]Extracting labels:  57%|█████▋    | 571/1000 [00:06<00:03, 115.81it/s]Extracting labels:  59%|█████▊    | 586/1000 [00:06<00:03, 124.89it/s]Extracting labels:  60%|██████    | 602/1000 [00:06<00:03, 125.64it/s]Extracting labels:  62%|██████▏   | 616/1000 [00:06<00:02, 128.22it/s]Extracting labels:  63%|██████▎   | 629/1000 [00:06<00:03, 118.00it/s]Extracting labels:  64%|██████▍   | 642/1000 [00:06<00:02, 120.19it/s]Extracting labels:  66%|██████▌   | 655/1000 [00:06<00:02, 115.41it/s]Extracting labels:  67%|██████▋   | 670/1000 [00:06<00:02, 122.71it/s]Extracting labels:  68%|██████▊   | 683/1000 [00:06<00:02, 123.99it/s]Extracting labels:  70%|██████▉   | 696/1000 [00:07<00:02, 122.88it/s]Extracting labels:  71%|███████▏  | 714/1000 [00:07<00:02, 134.94it/s]Extracting labels:  73%|███████▎  | 728/1000 [00:07<00:02, 129.07it/s]Extracting labels:  74%|███████▍  | 745/1000 [00:07<00:01, 138.92it/s]Extracting labels:  76%|███████▌  | 760/1000 [00:07<00:01, 134.51it/s]Extracting labels:  77%|███████▋  | 774/1000 [00:07<00:01, 127.86it/s]Extracting labels:  79%|███████▉  | 790/1000 [00:07<00:01, 135.50it/s]Extracting labels:  81%|████████  | 809/1000 [00:07<00:01, 148.63it/s]Extracting labels:  82%|████████▎ | 825/1000 [00:08<00:01, 134.73it/s]Extracting labels:  84%|████████▍ | 840/1000 [00:08<00:01, 128.77it/s]Extracting labels:  85%|████████▌ | 854/1000 [00:08<00:01, 130.45it/s]Extracting labels:  87%|████████▋ | 868/1000 [00:08<00:01, 130.66it/s]Extracting labels:  88%|████████▊ | 882/1000 [00:08<00:01, 117.57it/s]Extracting labels:  90%|████████▉ | 896/1000 [00:08<00:00, 121.78it/s]Extracting labels:  91%|█████████ | 910/1000 [00:08<00:00, 126.47it/s]Extracting labels:  93%|█████████▎| 926/1000 [00:08<00:00, 129.95it/s]Extracting labels:  94%|█████████▍| 940/1000 [00:08<00:00, 124.72it/s]Extracting labels:  95%|█████████▌| 954/1000 [00:09<00:00, 128.68it/s]Extracting labels:  97%|█████████▋| 969/1000 [00:09<00:00, 133.57it/s]Extracting labels:  98%|█████████▊| 983/1000 [00:09<00:00, 125.59it/s]Extracting labels: 100%|█████████▉| 996/1000 [00:09<00:00, 121.42it/s]Extracting labels: 100%|██████████| 1000/1000 [00:09<00:00, 105.90it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 58092.85it/s]
2026-01-23 21:10:20,579 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:10:20,623 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:10:20,626 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:10:20,637 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:10:20,926 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:10:20,928 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:10:20,930 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:10:20,933 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/meta-llama/Meta-Llama-3-8B-Instruct/hotpotqa with this file name: 5420933550.
2026-01-23 21:10:20,934 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:10:20,937 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
