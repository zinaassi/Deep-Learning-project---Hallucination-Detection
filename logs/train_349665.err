2026-01-23 21:10:35,812 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:35,814 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'Qwen/Qwen2.5-7B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'imdb', 'test_dataset': 'imdb_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:35,815 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'Qwen/Qwen2.5-7B-Instruct'
2026-01-23 21:10:35,818 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'Qwen/Qwen2.5-7B-Instruct' using training dataset 'imdb'.
2026-01-23 21:10:35,828 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:35,874 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:35,875 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:35,876 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   2%|▏         | 18/1000 [00:00<00:05, 179.19it/s]Extracting labels:   4%|▎         | 36/1000 [00:00<00:05, 178.01it/s]Extracting labels:   5%|▌         | 54/1000 [00:00<00:05, 177.84it/s]Extracting labels:   7%|▋         | 72/1000 [00:00<00:05, 171.00it/s]Extracting labels:   9%|▉         | 90/1000 [00:00<00:05, 169.81it/s]Extracting labels:  11%|█         | 108/1000 [00:00<00:05, 167.99it/s]Extracting labels:  12%|█▎        | 125/1000 [00:00<00:05, 168.31it/s]Extracting labels:  14%|█▍        | 143/1000 [00:00<00:05, 170.32it/s]Extracting labels:  16%|█▌        | 161/1000 [00:00<00:05, 162.11it/s]Extracting labels:  18%|█▊        | 179/1000 [00:01<00:04, 166.18it/s]Extracting labels:  20%|█▉        | 197/1000 [00:01<00:04, 169.12it/s]Extracting labels:  21%|██▏       | 214/1000 [00:01<00:04, 164.77it/s]Extracting labels:  23%|██▎       | 231/1000 [00:01<00:04, 165.08it/s]Extracting labels:  25%|██▍       | 248/1000 [00:01<00:04, 164.16it/s]Extracting labels:  27%|██▋       | 266/1000 [00:01<00:04, 167.74it/s]Extracting labels:  28%|██▊       | 284/1000 [00:01<00:04, 169.23it/s]Extracting labels:  30%|███       | 301/1000 [00:01<00:04, 169.22it/s]Extracting labels:  32%|███▏      | 319/1000 [00:01<00:04, 170.06it/s]Extracting labels:  34%|███▎      | 337/1000 [00:02<00:04, 164.57it/s]Extracting labels:  35%|███▌      | 354/1000 [00:02<00:03, 165.55it/s]Extracting labels:  37%|███▋      | 371/1000 [00:02<00:03, 166.37it/s]Extracting labels:  39%|███▉      | 388/1000 [00:02<00:03, 163.39it/s]Extracting labels:  41%|████      | 406/1000 [00:02<00:03, 165.44it/s]Extracting labels:  42%|████▏     | 423/1000 [00:02<00:03, 163.93it/s]Extracting labels:  44%|████▍     | 440/1000 [00:02<00:03, 165.09it/s]Extracting labels:  46%|████▌     | 458/1000 [00:02<00:03, 166.94it/s]Extracting labels:  48%|████▊     | 475/1000 [00:02<00:03, 160.61it/s]Extracting labels:  49%|████▉     | 492/1000 [00:02<00:03, 161.13it/s]Extracting labels:  51%|█████     | 509/1000 [00:03<00:03, 158.68it/s]Extracting labels:  52%|█████▎    | 525/1000 [00:03<00:03, 155.16it/s]Extracting labels:  54%|█████▍    | 541/1000 [00:03<00:03, 151.63it/s]Extracting labels:  56%|█████▌    | 558/1000 [00:03<00:02, 154.98it/s]Extracting labels:  57%|█████▊    | 575/1000 [00:03<00:02, 158.77it/s]Extracting labels:  59%|█████▉    | 591/1000 [00:03<00:02, 154.89it/s]Extracting labels:  61%|██████    | 609/1000 [00:03<00:02, 159.35it/s]Extracting labels:  62%|██████▎   | 625/1000 [00:03<00:02, 158.14it/s]Extracting labels:  64%|██████▍   | 641/1000 [00:03<00:02, 153.53it/s]Extracting labels:  66%|██████▌   | 657/1000 [00:04<00:02, 153.90it/s]Extracting labels:  67%|██████▋   | 673/1000 [00:04<00:02, 155.21it/s]Extracting labels:  69%|██████▉   | 690/1000 [00:04<00:01, 157.32it/s]Extracting labels:  71%|███████   | 707/1000 [00:04<00:01, 158.88it/s]Extracting labels:  72%|███████▎  | 725/1000 [00:04<00:01, 162.10it/s]Extracting labels:  74%|███████▍  | 742/1000 [00:04<00:01, 155.91it/s]Extracting labels:  76%|███████▌  | 759/1000 [00:04<00:01, 158.14it/s]Extracting labels:  78%|███████▊  | 776/1000 [00:04<00:01, 159.11it/s]Extracting labels:  79%|███████▉  | 793/1000 [00:04<00:01, 160.89it/s]Extracting labels:  81%|████████  | 810/1000 [00:04<00:01, 159.76it/s]Extracting labels:  83%|████████▎ | 827/1000 [00:05<00:01, 160.66it/s]Extracting labels:  84%|████████▍ | 844/1000 [00:05<00:00, 158.27it/s]Extracting labels:  86%|████████▌ | 861/1000 [00:05<00:00, 160.42it/s]Extracting labels:  88%|████████▊ | 878/1000 [00:05<00:00, 161.21it/s]Extracting labels:  90%|████████▉ | 895/1000 [00:05<00:00, 158.97it/s]Extracting labels:  91%|█████████ | 912/1000 [00:05<00:00, 159.31it/s]Extracting labels:  93%|█████████▎| 929/1000 [00:05<00:00, 161.56it/s]Extracting labels:  95%|█████████▍| 946/1000 [00:05<00:00, 162.17it/s]Extracting labels:  96%|█████████▋| 963/1000 [00:05<00:00, 160.55it/s]Extracting labels:  98%|█████████▊| 980/1000 [00:06<00:00, 150.17it/s]Extracting labels: 100%|█████████▉| 996/1000 [00:06<00:00, 151.17it/s]Extracting labels: 100%|██████████| 1000/1000 [00:06<00:00, 161.45it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 49813.59it/s]
2026-01-23 21:10:42,076 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:10:42,120 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:10:42,122 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:10:42,131 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:10:42,426 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:10:42,428 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:10:42,432 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:10:42,435 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/Qwen/Qwen2.5-7B-Instruct/imdb with this file name: 5442435578.
2026-01-23 21:10:42,436 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:10:42,437 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
