2026-01-23 21:14:43,215 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:14:43,216 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'Qwen/Qwen2.5-7B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'imdb', 'test_dataset': 'imdb_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:14:43,217 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'Qwen/Qwen2.5-7B-Instruct'
2026-01-23 21:14:43,218 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'Qwen/Qwen2.5-7B-Instruct' using training dataset 'imdb'.
2026-01-23 21:14:43,231 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:14:43,288 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:14:43,290 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:14:43,291 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   0%|          | 1/1000 [00:00<03:56,  4.23it/s]Extracting labels:   1%|          | 11/1000 [00:00<00:24, 39.92it/s]Extracting labels:   2%|▏         | 22/1000 [00:00<00:15, 64.21it/s]Extracting labels:   3%|▎         | 31/1000 [00:00<00:15, 64.33it/s]Extracting labels:   4%|▍         | 43/1000 [00:00<00:12, 79.30it/s]Extracting labels:   6%|▌         | 55/1000 [00:00<00:10, 88.13it/s]Extracting labels:   6%|▋         | 65/1000 [00:00<00:10, 91.31it/s]Extracting labels:   8%|▊         | 75/1000 [00:01<00:10, 89.97it/s]Extracting labels:   9%|▉         | 89/1000 [00:01<00:08, 103.96it/s]Extracting labels:  10%|█         | 101/1000 [00:01<00:08, 107.21it/s]Extracting labels:  11%|█▏        | 114/1000 [00:01<00:07, 112.37it/s]Extracting labels:  13%|█▎        | 127/1000 [00:01<00:07, 116.54it/s]Extracting labels:  14%|█▍        | 140/1000 [00:01<00:07, 119.23it/s]Extracting labels:  15%|█▌        | 153/1000 [00:01<00:07, 111.20it/s]Extracting labels:  17%|█▋        | 168/1000 [00:01<00:06, 119.79it/s]Extracting labels:  18%|█▊        | 182/1000 [00:01<00:06, 123.37it/s]Extracting labels:  20%|█▉        | 195/1000 [00:02<00:06, 115.78it/s]Extracting labels:  21%|██        | 208/1000 [00:02<00:06, 117.82it/s]Extracting labels:  22%|██▏       | 220/1000 [00:02<00:07, 107.83it/s]Extracting labels:  23%|██▎       | 232/1000 [00:02<00:06, 110.22it/s]Extracting labels:  24%|██▍       | 244/1000 [00:02<00:06, 110.56it/s]Extracting labels:  26%|██▌       | 256/1000 [00:02<00:06, 111.46it/s]Extracting labels:  27%|██▋       | 268/1000 [00:02<00:06, 105.85it/s]Extracting labels:  28%|██▊       | 280/1000 [00:02<00:06, 107.59it/s]Extracting labels:  29%|██▉       | 294/1000 [00:02<00:06, 115.74it/s]Extracting labels:  31%|███       | 306/1000 [00:03<00:06, 104.51it/s]Extracting labels:  32%|███▏      | 321/1000 [00:03<00:05, 114.46it/s]Extracting labels:  33%|███▎      | 333/1000 [00:03<00:05, 111.91it/s]Extracting labels:  35%|███▍      | 346/1000 [00:03<00:05, 116.69it/s]Extracting labels:  36%|███▌      | 358/1000 [00:03<00:06, 105.86it/s]Extracting labels:  37%|███▋      | 373/1000 [00:03<00:05, 116.89it/s]Extracting labels:  39%|███▊      | 386/1000 [00:03<00:05, 114.24it/s]Extracting labels:  40%|████      | 400/1000 [00:03<00:05, 119.35it/s]Extracting labels:  41%|████▏     | 413/1000 [00:03<00:04, 121.69it/s]Extracting labels:  43%|████▎     | 426/1000 [00:04<00:04, 116.72it/s]Extracting labels:  44%|████▍     | 438/1000 [00:04<00:05, 109.40it/s]Extracting labels:  45%|████▌     | 450/1000 [00:04<00:06, 86.38it/s] Extracting labels:  46%|████▋     | 465/1000 [00:04<00:05, 99.78it/s]Extracting labels:  48%|████▊     | 480/1000 [00:04<00:04, 111.79it/s]Extracting labels:  50%|████▉     | 496/1000 [00:04<00:04, 123.09it/s]Extracting labels:  51%|█████     | 510/1000 [00:04<00:03, 124.03it/s]Extracting labels:  52%|█████▎    | 525/1000 [00:04<00:03, 129.40it/s]Extracting labels:  54%|█████▍    | 539/1000 [00:05<00:03, 128.37it/s]Extracting labels:  55%|█████▌    | 553/1000 [00:05<00:03, 129.20it/s]Extracting labels:  57%|█████▋    | 569/1000 [00:05<00:03, 136.58it/s]Extracting labels:  58%|█████▊    | 584/1000 [00:05<00:03, 138.33it/s]Extracting labels:  60%|██████    | 600/1000 [00:05<00:02, 142.17it/s]Extracting labels:  62%|██████▏   | 616/1000 [00:05<00:02, 145.58it/s]Extracting labels:  63%|██████▎   | 631/1000 [00:05<00:02, 142.43it/s]Extracting labels:  65%|██████▍   | 647/1000 [00:05<00:02, 145.12it/s]Extracting labels:  66%|██████▋   | 663/1000 [00:05<00:02, 146.86it/s]Extracting labels:  68%|██████▊   | 678/1000 [00:05<00:02, 144.18it/s]Extracting labels:  70%|██████▉   | 695/1000 [00:06<00:02, 148.70it/s]Extracting labels:  71%|███████   | 710/1000 [00:06<00:01, 148.31it/s]Extracting labels:  72%|███████▎  | 725/1000 [00:06<00:02, 135.22it/s]Extracting labels:  74%|███████▍  | 739/1000 [00:06<00:02, 127.38it/s]Extracting labels:  75%|███████▌  | 754/1000 [00:06<00:01, 131.67it/s]Extracting labels:  77%|███████▋  | 768/1000 [00:06<00:01, 133.52it/s]Extracting labels:  78%|███████▊  | 784/1000 [00:06<00:01, 138.98it/s]Extracting labels:  80%|███████▉  | 799/1000 [00:06<00:01, 141.32it/s]Extracting labels:  81%|████████▏ | 814/1000 [00:06<00:01, 139.07it/s]Extracting labels:  83%|████████▎ | 829/1000 [00:07<00:01, 141.01it/s]Extracting labels:  84%|████████▍ | 844/1000 [00:07<00:01, 141.51it/s]Extracting labels:  86%|████████▌ | 859/1000 [00:07<00:01, 138.47it/s]Extracting labels:  87%|████████▋ | 873/1000 [00:07<00:00, 136.70it/s]Extracting labels:  89%|████████▊ | 887/1000 [00:07<00:00, 131.50it/s]Extracting labels:  90%|█████████ | 901/1000 [00:07<00:00, 131.12it/s]Extracting labels:  92%|█████████▏| 915/1000 [00:07<00:00, 124.69it/s]Extracting labels:  93%|█████████▎| 931/1000 [00:07<00:00, 133.18it/s]Extracting labels:  94%|█████████▍| 945/1000 [00:07<00:00, 128.76it/s]Extracting labels:  96%|█████████▌| 961/1000 [00:08<00:00, 136.88it/s]Extracting labels:  98%|█████████▊| 975/1000 [00:08<00:00, 114.25it/s]Extracting labels:  99%|█████████▉| 988/1000 [00:08<00:00, 106.68it/s]Extracting labels: 100%|██████████| 1000/1000 [00:08<00:00, 117.87it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 60262.99it/s]
2026-01-23 21:14:51,781 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:14:51,828 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:14:51,829 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:14:51,838 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:14:52,197 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:14:52,198 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:14:52,200 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:14:52,202 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/Qwen/Qwen2.5-7B-Instruct/imdb with this file name: 5692202084.
2026-01-23 21:14:52,203 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:14:52,204 - AppLogger - [INFO] - main.py:352 - Starting training loop.
2026-01-23 21:14:53,503 - AppLogger - [INFO] - main.py:190 - Epoch 1/100
Training Progress:   0%|          | 0/13 [00:00<?, ?it/s]Training Progress:   8%|▊         | 1/13 [00:03<00:39,  3.27s/it]Training Progress:  23%|██▎       | 3/13 [00:03<00:08,  1.12it/s]Training Progress:  38%|███▊      | 5/13 [00:03<00:03,  2.14it/s]Training Progress:  54%|█████▍    | 7/13 [00:03<00:01,  3.37it/s]Training Progress:  69%|██████▉   | 9/13 [00:03<00:00,  4.84it/s]Training Progress:  85%|████████▍ | 11/13 [00:03<00:00,  6.47it/s]Training Progress: 100%|██████████| 13/13 [00:04<00:00,  3.25it/s]
2026-01-23 21:14:57,515 - AppLogger - [INFO] - main.py:194 - Train Loss: 0.7383, Train AUC: 0.4531
Validation Progress:   0%|          | 0/4 [00:00<?, ?it/s]Validation Progress:  25%|██▌       | 1/4 [00:00<00:00,  3.07it/s]Validation Progress: 100%|██████████| 4/4 [00:00<00:00,  9.44it/s]
2026-01-23 21:14:57,942 - AppLogger - [INFO] - main.py:198 - Val Loss: 0.6840, Val AUC: 0.3867, Val TPR@5%FPR: 0.0000
Test Progress:   0%|          | 0/16 [00:00<?, ?it/s]Test Progress:   6%|▋         | 1/16 [00:01<00:16,  1.11s/it]../aten/src/ATen/native/cuda/Loss.cu:94: operator(): block: [0,0,0], thread: [15,0,0] Assertion `input_val >= zero && input_val <= one` failed.
Test Progress:  25%|██▌       | 4/16 [00:02<00:08,  1.45it/s]
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 356, in main
    train_model(logger=logger, model=model, dataloader_train=dataloader_train, dataloader_val=dataloader_val, dataloader_test=dataloader_test, criterion=criterion, optimizer=optimizer, scheduler=scheduler, args=args, device=device)
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 201, in train_model
    test_loss, auc_test, tpr_5_fpr_test = evaluate(model, dataloader_test, criterion, device, desc="Test", input_type=args.input_type)
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 159, in evaluate
    total_loss += loss.item()
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

