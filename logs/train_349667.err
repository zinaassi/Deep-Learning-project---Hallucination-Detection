2026-01-23 21:10:55,460 - AppLogger - [INFO] - main.py:247 - Starting the data processing pipeline.
2026-01-23 21:10:55,461 - AppLogger - [INFO] - main.py:248 - Parsed Arguments: {'LLM': 'meta-llama/Meta-Llama-3-8B-Instruct', 'base_raw_data_dir': '/home/guy_b/big-storage/raw_data', 'train_dataset': 'movies', 'test_dataset': 'movies_test', 'base_pre_processed_data_dir': '/home/zina.assi/Deep-Learning-project---Hallucination-Detection/data/pre_processed_data', 'probe_model': 'ImprovedLOSNet', 'topk_preprocess': 1000, 'input_output_type': 'output', 'topk_dim': 1000, 'N_max': 100, 'num_folds': 5, 'fold_to_run': 0, 'input_type': 'LOS', 'seed': 0, 'cuda_idx': 0, 'batch_size': 64, 'hidden_dim': 128, 'heads': 8, 'dropout': 0.1, 'num_layers': 2, 'pool': 'cls', 'patience': 20, 'num_epochs': 100, 'best_model_path': 'saved_models', 'lr': 0.0001, 'rank_encoding': 'scale_encoding', 'weight_decay': 0.001, 'num_workers': 4, 'pin_memory': 1, 'rank_embed_dim': 128, 'use_rank_embed': True, 'use_entropy': True, 'use_gaps': True, 'distill_alpha': 0.5, 'distill_temp': 2.0}
2026-01-23 21:10:55,463 - AppLogger - [INFO] - main.py:255 - Loading preproccessed data for model 'meta-llama/Meta-Llama-3-8B-Instruct'
2026-01-23 21:10:55,464 - AppLogger - [INFO] - main.py:25 - Starting data preparation for model 'meta-llama/Meta-Llama-3-8B-Instruct' using training dataset 'movies'.
2026-01-23 21:10:55,474 - AppLogger - [INFO] - main.py:91 - Training dataset loaded successfully.
2026-01-23 21:10:55,568 - AppLogger - [INFO] - main.py:100 - Test dataset loaded successfully.
2026-01-23 21:10:55,570 - AppLogger - [INFO] - main.py:102 - Dataset processing pipeline completed successfully.
2026-01-23 21:10:55,571 - AppLogger - [INFO] - main.py:260 - Splitting dataset into train, validation, and test indices.
Extracting labels:   0%|          | 0/1000 [00:00<?, ?it/s]Extracting labels:   2%|▏         | 17/1000 [00:00<00:05, 165.71it/s]Extracting labels:   3%|▎         | 34/1000 [00:00<00:06, 144.06it/s]Extracting labels:   5%|▍         | 49/1000 [00:00<00:08, 118.66it/s]Extracting labels:   6%|▌         | 62/1000 [00:00<00:08, 111.67it/s]Extracting labels:   7%|▋         | 74/1000 [00:00<00:08, 107.51it/s]Extracting labels:   8%|▊         | 85/1000 [00:00<00:09, 99.77it/s] Extracting labels:  10%|▉         | 96/1000 [00:00<00:09, 99.83it/s]Extracting labels:  11%|█         | 107/1000 [00:01<00:09, 95.00it/s]Extracting labels:  12%|█▏        | 120/1000 [00:01<00:08, 102.81it/s]Extracting labels:  13%|█▎        | 131/1000 [00:01<00:08, 98.31it/s] Extracting labels:  14%|█▍        | 142/1000 [00:01<00:08, 98.43it/s]Extracting labels:  15%|█▌        | 152/1000 [00:01<00:09, 85.30it/s]Extracting labels:  16%|█▌        | 162/1000 [00:01<00:09, 87.18it/s]Extracting labels:  17%|█▋        | 171/1000 [00:01<00:09, 86.96it/s]Extracting labels:  18%|█▊        | 180/1000 [00:01<00:09, 82.24it/s]Extracting labels:  19%|█▉        | 191/1000 [00:01<00:09, 82.83it/s]Extracting labels:  20%|██        | 200/1000 [00:02<00:10, 77.29it/s]Extracting labels:  21%|██        | 210/1000 [00:02<00:10, 78.51it/s]Extracting labels:  22%|██▏       | 219/1000 [00:02<00:09, 78.68it/s]Extracting labels:  23%|██▎       | 227/1000 [00:02<00:09, 77.73it/s]Extracting labels:  24%|██▎       | 235/1000 [00:02<00:10, 72.04it/s]Extracting labels:  24%|██▍       | 243/1000 [00:02<00:10, 69.09it/s]Extracting labels:  25%|██▌       | 251/1000 [00:02<00:10, 69.19it/s]Extracting labels:  26%|██▋       | 263/1000 [00:02<00:09, 76.40it/s]Extracting labels:  27%|██▋       | 271/1000 [00:03<00:09, 76.71it/s]Extracting labels:  28%|██▊       | 281/1000 [00:03<00:08, 82.90it/s]Extracting labels:  29%|██▉       | 290/1000 [00:03<00:09, 73.14it/s]Extracting labels:  30%|██▉       | 299/1000 [00:03<00:09, 77.08it/s]Extracting labels:  31%|███       | 310/1000 [00:03<00:08, 84.91it/s]Extracting labels:  32%|███▏      | 319/1000 [00:03<00:08, 75.77it/s]Extracting labels:  33%|███▎      | 331/1000 [00:03<00:07, 86.50it/s]Extracting labels:  35%|███▍      | 348/1000 [00:03<00:06, 108.14it/s]Extracting labels:  36%|███▌      | 362/1000 [00:04<00:05, 111.28it/s]Extracting labels:  37%|███▋      | 374/1000 [00:04<00:05, 104.60it/s]Extracting labels:  39%|███▊      | 386/1000 [00:04<00:05, 107.22it/s]Extracting labels:  40%|███▉      | 399/1000 [00:04<00:05, 113.24it/s]Extracting labels:  42%|████▏     | 415/1000 [00:04<00:04, 126.20it/s]Extracting labels:  43%|████▎     | 428/1000 [00:04<00:04, 125.01it/s]Extracting labels:  44%|████▍     | 444/1000 [00:04<00:04, 133.48it/s]Extracting labels:  46%|████▌     | 458/1000 [00:04<00:04, 110.61it/s]Extracting labels:  47%|████▋     | 470/1000 [00:04<00:04, 109.43it/s]Extracting labels:  48%|████▊     | 482/1000 [00:05<00:04, 108.10it/s]Extracting labels:  50%|████▉     | 498/1000 [00:05<00:04, 116.33it/s]Extracting labels:  51%|█████     | 510/1000 [00:05<00:04, 112.30it/s]Extracting labels:  52%|█████▏    | 524/1000 [00:05<00:03, 119.41it/s]Extracting labels:  54%|█████▎    | 537/1000 [00:05<00:03, 119.25it/s]Extracting labels:  55%|█████▌    | 553/1000 [00:05<00:03, 128.23it/s]Extracting labels:  57%|█████▋    | 567/1000 [00:05<00:03, 131.17it/s]Extracting labels:  58%|█████▊    | 581/1000 [00:05<00:03, 116.95it/s]Extracting labels:  60%|█████▉    | 595/1000 [00:05<00:03, 121.57it/s]Extracting labels:  61%|██████    | 608/1000 [00:06<00:03, 112.24it/s]Extracting labels:  62%|██████▏   | 621/1000 [00:06<00:03, 115.38it/s]Extracting labels:  63%|██████▎   | 634/1000 [00:06<00:03, 118.66it/s]Extracting labels:  65%|██████▍   | 648/1000 [00:06<00:02, 124.14it/s]Extracting labels:  66%|██████▌   | 661/1000 [00:06<00:03, 109.57it/s]Extracting labels:  67%|██████▋   | 673/1000 [00:06<00:03, 82.38it/s] Extracting labels:  68%|██████▊   | 685/1000 [00:06<00:03, 90.08it/s]Extracting labels:  70%|██████▉   | 698/1000 [00:07<00:03, 98.57it/s]Extracting labels:  71%|███████▏  | 713/1000 [00:07<00:02, 107.90it/s]Extracting labels:  73%|███████▎  | 726/1000 [00:07<00:02, 111.13it/s]Extracting labels:  74%|███████▍  | 738/1000 [00:07<00:02, 111.00it/s]Extracting labels:  75%|███████▌  | 750/1000 [00:07<00:02, 98.44it/s] Extracting labels:  76%|███████▌  | 761/1000 [00:07<00:02, 95.61it/s]Extracting labels:  78%|███████▊  | 775/1000 [00:07<00:02, 106.39it/s]Extracting labels:  79%|███████▉  | 790/1000 [00:07<00:01, 117.28it/s]Extracting labels:  80%|████████  | 803/1000 [00:07<00:01, 112.45it/s]Extracting labels:  82%|████████▏ | 815/1000 [00:08<00:01, 111.39it/s]Extracting labels:  83%|████████▎ | 827/1000 [00:08<00:01, 108.88it/s]Extracting labels:  84%|████████▍ | 840/1000 [00:08<00:01, 113.02it/s]Extracting labels:  85%|████████▌ | 854/1000 [00:08<00:01, 118.61it/s]Extracting labels:  87%|████████▋ | 868/1000 [00:08<00:01, 122.17it/s]Extracting labels:  88%|████████▊ | 881/1000 [00:08<00:00, 119.12it/s]Extracting labels:  90%|████████▉ | 895/1000 [00:08<00:00, 124.42it/s]Extracting labels:  91%|█████████ | 908/1000 [00:08<00:00, 112.37it/s]Extracting labels:  92%|█████████▏| 923/1000 [00:08<00:00, 121.33it/s]Extracting labels:  94%|█████████▎| 936/1000 [00:09<00:00, 123.10it/s]Extracting labels:  95%|█████████▍| 949/1000 [00:09<00:00, 122.18it/s]Extracting labels:  96%|█████████▌| 962/1000 [00:09<00:00, 112.02it/s]Extracting labels:  97%|█████████▋| 974/1000 [00:09<00:00, 94.58it/s] Extracting labels:  99%|█████████▊| 987/1000 [00:09<00:00, 99.50it/s]Extracting labels: 100%|██████████| 1000/1000 [00:09<00:00, 103.20it/s]
Processing folds:   0%|          | 0/5 [00:00<?, ?it/s]Processing folds: 100%|██████████| 5/5 [00:00<00:00, 44620.26it/s]
2026-01-23 21:11:05,267 - AppLogger - [INFO] - main.py:276 - Train size: 800, Validation size: 200, Test indices: 1000
2026-01-23 21:11:05,339 - AppLogger - [INFO] - main.py:285 - Running fold 1 of 5.
2026-01-23 21:11:05,341 - AppLogger - [INFO] - main.py:287 - Creating dataloaders for training, validation, and test sets.
2026-01-23 21:11:05,350 - AppLogger - [INFO] - main.py:318 - Creating model for input type: LOS with sequence length 100 and feature dimension: 1000
2026-01-23 21:11:05,736 - AppLogger - [INFO] - main.py:327 - Total number of parameters in the model: 450561
2026-01-23 21:11:05,740 - AppLogger - [INFO] - main.py:330 - Creating optimizer and scheduler.
2026-01-23 21:11:05,747 - AppLogger - [INFO] - main.py:335 - Total number of training steps: 1300, and warm-up steps: 130
2026-01-23 21:11:05,748 - AppLogger - [INFO] - main.py:350 - will save the best model in this folder: saved_models/meta-llama/Meta-Llama-3-8B-Instruct/movies with this file name: 5465748764.
2026-01-23 21:11:05,749 - AppLogger - [INFO] - main.py:351 - Starting wandb, project is LOS-Net.
2026-01-23 21:11:05,750 - AppLogger - [INFO] - main.py:352 - Starting training loop.
wandb: ERROR api_key not configured (no-tty). call wandb.login(key=[your_api_key])
Traceback (most recent call last):
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 359, in <module>
    main()
  File "/home/zina.assi/Deep-Learning-project---Hallucination-Detection/main.py", line 354, in main
    wandb.init(project="LOS-Net", config=args)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1189, in init
    raise e
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1166, in init
    wi.setup(kwargs)
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 308, in setup
    wandb_login._login(
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 298, in _login
    wlogin.prompt_api_key()
  File "/home/zina.assi/miniconda3/envs/LOS_Net/lib/python3.10/site-packages/wandb/sdk/wandb_login.py", line 228, in prompt_api_key
    raise UsageError("api_key not configured (no-tty). call " + directive)
wandb.errors.UsageError: api_key not configured (no-tty). call wandb.login(key=[your_api_key])
